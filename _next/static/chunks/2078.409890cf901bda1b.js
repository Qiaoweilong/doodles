"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2078],{12078:function(t,e,n){n.r(e),n.d(e,{default:function(){return g}});var s=n(98404),i=n.n(s),o=n(46160),r=n(96641),c=n(81382),h=n(58178),a=n.n(h),d=n(71516),u=n(4337),v=n.n(u),l=n(73416),f=n(56186);class p extends l.XR{constructor(t){super(),this.events=new(a()),this.accounts=[],this.chainId=1,this.pending=!1,this.bridge="https://bridge.walletconnect.org",this.qrcode=!0,this.qrcodeModalOptions=void 0,this.opts=t,this.chainId=(null===t||void 0===t?void 0:t.chainId)||this.chainId,this.wc=this.register(t)}get connected(){return"undefined"!==typeof this.wc&&this.wc.connected}get connecting(){return this.pending}get connector(){return this.wc=this.register(this.opts),this.wc}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t){if(!this.connected)return new Promise(((e,n)=>{this.on("error",(t=>{n(t)})),this.on("open",(()=>{e()})),this.create(t)}));this.onOpen()}async close(){"undefined"!==typeof this.wc&&(this.wc.connected&&this.wc.killSession(),this.onClose())}async send(t){this.wc=this.register(this.opts),this.connected||await this.open(),this.sendPayload(t).then((t=>this.events.emit("payload",t))).catch((e=>this.events.emit("payload",(0,f.formatJsonRpcError)(t.id,e.message))))}register(t){if(this.wc)return this.wc;this.opts=t||this.opts,this.bridge=(null===t||void 0===t?void 0:t.connector)?t.connector.bridge:(null===t||void 0===t?void 0:t.bridge)||"https://bridge.walletconnect.org",this.qrcode="undefined"===typeof(null===t||void 0===t?void 0:t.qrcode)||!1!==t.qrcode,this.chainId="undefined"!==typeof(null===t||void 0===t?void 0:t.chainId)?t.chainId:this.chainId,this.qrcodeModalOptions=null===t||void 0===t?void 0:t.qrcodeModalOptions;const e={bridge:this.bridge,qrcodeModal:this.qrcode?v():void 0,qrcodeModalOptions:this.qrcodeModalOptions,storageId:null===t||void 0===t?void 0:t.storageId,signingMethods:null===t||void 0===t?void 0:t.signingMethods,clientMeta:null===t||void 0===t?void 0:t.clientMeta};if(this.wc="undefined"!==typeof(null===t||void 0===t?void 0:t.connector)?t.connector:new d.Z(e),"undefined"===typeof this.wc)throw new Error("Failed to register WalletConnect connector");return this.wc.accounts.length&&(this.accounts=this.wc.accounts),this.wc.chainId&&(this.chainId=this.wc.chainId),this.registerConnectorEvents(),this.wc}onOpen(t){this.pending=!1,t&&(this.wc=t),this.events.emit("open")}onClose(){this.pending=!1,this.wc&&(this.wc=void 0),this.events.emit("close")}onError(t,e="Failed or Rejected Request",n=-32e3,s){const i={id:t.id,jsonrpc:t.jsonrpc,error:{code:n,message:e}};return"undefined"!==typeof s&&(i.error.data=s),this.events.emit("payload",i),i}create(t){this.wc=this.register(this.opts),this.chainId=t||this.chainId,this.connected||this.pending||(this.pending=!0,this.registerConnectorEvents(),this.wc.createSession({chainId:this.chainId}).then((()=>this.events.emit("created"))).catch((t=>this.events.emit("error",t))))}registerConnectorEvents(){this.wc=this.register(this.opts),this.wc.on("connect",(t=>{var e,n;t?this.events.emit("error",t):(this.accounts=(null===(e=this.wc)||void 0===e?void 0:e.accounts)||[],this.chainId=(null===(n=this.wc)||void 0===n?void 0:n.chainId)||this.chainId,this.onOpen())})),this.wc.on("disconnect",(t=>{t?this.events.emit("error",t):this.onClose()})),this.wc.on("modal_closed",(()=>{this.events.emit("error",new Error("User closed modal"))})),this.wc.on("session_update",((t,e)=>{const{accounts:n,chainId:s}=e.params[0];(!this.accounts||n&&this.accounts!==n)&&(this.accounts=n,this.events.emit("accountsChanged",n)),(!this.chainId||s&&this.chainId!==s)&&(this.chainId=s,this.events.emit("chainChanged",s))}))}async sendPayload(t){this.wc=this.register(this.opts);try{const e=await this.wc.unsafeSend(t);return this.sanitizeResponse(e)}catch(e){return this.onError(t,e.message)}}sanitizeResponse(t){return"undefined"!==typeof t.error&&"undefined"===typeof t.error.code?(0,f.formatJsonRpcError)(t.id,t.error.message,t.error.data):t}}var g=class{constructor(t){this.events=new(i()),this.rpc={infuraId:null===t||void 0===t?void 0:t.infuraId,custom:null===t||void 0===t?void 0:t.rpc},this.signer=new o.r(new p(t));const e=this.signer.connection.chainId||(null===t||void 0===t?void 0:t.chainId)||1;this.http=this.setHttpProvider(e),this.registerEventListeners()}get connected(){return this.signer.connection.connected}get connector(){return this.signer.connection.connector}get accounts(){return this.signer.connection.accounts}get chainId(){return this.signer.connection.chainId}get rpcUrl(){var t;return(null===(t=this.http)||void 0===t?void 0:t.connection).url||""}async request(t){switch(t.method){case"eth_requestAccounts":return await this.connect(),this.signer.connection.accounts;case"eth_accounts":return this.signer.connection.accounts;case"eth_chainId":return this.signer.connection.chainId}if(c.V7.includes(t.method))return this.signer.request(t);if("undefined"===typeof this.http)throw new Error(`Cannot request JSON-RPC method (${t.method}) without provided rpc url`);return this.http.request(t)}sendAsync(t,e){this.request(t).then((t=>e(null,t))).catch((t=>e(t,void 0)))}async enable(){return await this.request({method:"eth_requestAccounts"})}async connect(){this.signer.connection.connected||await this.signer.connect()}async disconnect(){this.signer.connection.connected&&await this.signer.disconnect()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}registerEventListeners(){this.signer.connection.on("accountsChanged",(t=>{this.events.emit("accountsChanged",t)})),this.signer.connection.on("chainChanged",(t=>{this.http=this.setHttpProvider(t),this.events.emit("chainChanged",t)})),this.signer.on("disconnect",(()=>{this.events.emit("disconnect")}))}setHttpProvider(t){const e=(0,c.RM)(t,this.rpc);if("undefined"===typeof e)return;return new o.r(new r.k(e))}}},98404:function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,s,o,r){if("function"!==typeof s)throw new TypeError("The listener must be a function");var c=new i(s,o||t,r),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],c]:t._events[h].push(c):(t._events[h]=c,t._eventsCount++),t}function r(t,e){0===--t._eventsCount?t._events=new s:delete t._events[e]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),c.prototype.eventNames=function(){var t,s,i=[];if(0===this._eventsCount)return i;for(s in t=this._events)e.call(t,s)&&i.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},c.prototype.listeners=function(t){var e=n?n+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var i=0,o=s.length,r=new Array(o);i<o;i++)r[i]=s[i].fn;return r},c.prototype.listenerCount=function(t){var e=n?n+t:t,s=this._events[e];return s?s.fn?1:s.length:0},c.prototype.emit=function(t,e,s,i,o,r){var c=n?n+t:t;if(!this._events[c])return!1;var h,a,d=this._events[c],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,e),!0;case 3:return d.fn.call(d.context,e,s),!0;case 4:return d.fn.call(d.context,e,s,i),!0;case 5:return d.fn.call(d.context,e,s,i,o),!0;case 6:return d.fn.call(d.context,e,s,i,o,r),!0}for(a=1,h=new Array(u-1);a<u;a++)h[a-1]=arguments[a];d.fn.apply(d.context,h)}else{var v,l=d.length;for(a=0;a<l;a++)switch(d[a].once&&this.removeListener(t,d[a].fn,void 0,!0),u){case 1:d[a].fn.call(d[a].context);break;case 2:d[a].fn.call(d[a].context,e);break;case 3:d[a].fn.call(d[a].context,e,s);break;case 4:d[a].fn.call(d[a].context,e,s,i);break;default:if(!h)for(v=1,h=new Array(u-1);v<u;v++)h[v-1]=arguments[v];d[a].fn.apply(d[a].context,h)}}return!0},c.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,s,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return r(this,o),this;var c=this._events[o];if(c.fn)c.fn!==e||i&&!c.once||s&&c.context!==s||r(this,o);else{for(var h=0,a=[],d=c.length;h<d;h++)(c[h].fn!==e||i&&!c[h].once||s&&c[h].context!==s)&&a.push(c[h]);a.length?this._events[o]=1===a.length?a[0]:a:r(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&r(this,e)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,t.exports=c},58178:function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,s,o,r){if("function"!==typeof s)throw new TypeError("The listener must be a function");var c=new i(s,o||t,r),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],c]:t._events[h].push(c):(t._events[h]=c,t._eventsCount++),t}function r(t,e){0===--t._eventsCount?t._events=new s:delete t._events[e]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),c.prototype.eventNames=function(){var t,s,i=[];if(0===this._eventsCount)return i;for(s in t=this._events)e.call(t,s)&&i.push(n?s.slice(1):s);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},c.prototype.listeners=function(t){var e=n?n+t:t,s=this._events[e];if(!s)return[];if(s.fn)return[s.fn];for(var i=0,o=s.length,r=new Array(o);i<o;i++)r[i]=s[i].fn;return r},c.prototype.listenerCount=function(t){var e=n?n+t:t,s=this._events[e];return s?s.fn?1:s.length:0},c.prototype.emit=function(t,e,s,i,o,r){var c=n?n+t:t;if(!this._events[c])return!1;var h,a,d=this._events[c],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,e),!0;case 3:return d.fn.call(d.context,e,s),!0;case 4:return d.fn.call(d.context,e,s,i),!0;case 5:return d.fn.call(d.context,e,s,i,o),!0;case 6:return d.fn.call(d.context,e,s,i,o,r),!0}for(a=1,h=new Array(u-1);a<u;a++)h[a-1]=arguments[a];d.fn.apply(d.context,h)}else{var v,l=d.length;for(a=0;a<l;a++)switch(d[a].once&&this.removeListener(t,d[a].fn,void 0,!0),u){case 1:d[a].fn.call(d[a].context);break;case 2:d[a].fn.call(d[a].context,e);break;case 3:d[a].fn.call(d[a].context,e,s);break;case 4:d[a].fn.call(d[a].context,e,s,i);break;default:if(!h)for(v=1,h=new Array(u-1);v<u;v++)h[v-1]=arguments[v];d[a].fn.apply(d[a].context,h)}}return!0},c.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,s,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return r(this,o),this;var c=this._events[o];if(c.fn)c.fn!==e||i&&!c.once||s&&c.context!==s||r(this,o);else{for(var h=0,a=[],d=c.length;h<d;h++)(c[h].fn!==e||i&&!c[h].once||s&&c[h].context!==s)&&a.push(c[h]);a.length?this._events[o]=1===a.length?a[0]:a:r(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&r(this,e)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,t.exports=c}}]);